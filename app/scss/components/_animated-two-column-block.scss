@use '../base/globals' as *;

.animated-two-column-block {
  /* default slide-in direction (from RIGHT) */
  --slide-x: 4rem;

  @include respond-up(small) {
    @include flex-between;
    align-items: stretch;
  }

  &__wrapper {
    background: unset;
  }

  &__image {
    position: relative;    
    overflow: hidden; 
    min-height: 0;    

    @include respond-up(small) { 
      width: 50%; 
    }

    img {
      display: block;
      position: absolute;    
      inset: 0;              
      width: 100%;           
      height: 100%;
      object-fit: cover;    
      object-position: top;

      /* fade the RIGHT edge into white */
      --edge-fade: 28%;

      -webkit-mask-image: linear-gradient(
        to right,
        #000 0%,
        #000 calc(100% - var(--edge-fade)),
        rgba(0,0,0,0) 100%
      );
      mask-image: linear-gradient(
        to right,
        #000 0%,
        #000 calc(100% - var(--edge-fade)),
        rgba(0,0,0,0) 100%
      );
    }
  }

  &__content {
    position: relative;
    z-index: 2;
    min-height: 0;
    padding-bottom: 40px;

    @include respond-up(small) { 
      width: 50%; 
    }
  }

  &__heading {
    margin: 24px 0 32px -112px;
    font-size: clamp(40px, 55vw, 4vw); 
    color: $colorTwo;
  }

  &__description {
    width: 80%;
    margin: auto auto 0;
    font-size: 18px;
    line-height: 32px;
    color: $white;
  }

  .primary-button { margin-top: 40px; }

  li { margin-top: 8px; list-style-type: disc; }

  /* ===== Reversed layout: image on RIGHT, text on LEFT ===== */
  &.reverse--1 {
    /* flip layout on â‰¥ small */
    @include respond-up(small) { flex-direction: row-reverse; }

    /* flip slide direction (now from LEFT) */
    --slide-x: -4rem;

    .animated-two-column-block__heading {
      margin: 24px -112px 32px 0;
      text-align: right;
    }

    .animated-two-column-block__description {
      margin: 0 32px 0 auto;
      text-align: right;
    }

    .primary-button { 
      margin-left: auto; 
    }

    /* fade the LEFT edge when the image sits on the right */
    .animated-two-column-block__image img {
      -webkit-mask-image: linear-gradient(
        to right,
        rgba(0,0,0,0) 0%,
        #000 var(--edge-fade),
        #000 100%
      );
      mask-image: linear-gradient(
        to right,
        rgba(0,0,0,0) 0%,
        #000 var(--edge-fade),
        #000 100%
      );
    }
  }
}

/* ===== Animation (JS toggles .is-in-view on the inner block) ===== */
.js .animated-two-column-block {
  &__heading,
  &__description {
    opacity: 0;
    transform: translateX(var(--slide-x, 4rem)); /* direction set per block */
    transition:
      transform 820ms cubic-bezier(.2,.7,.2,1),
      opacity 800ms ease;
    will-change: transform, opacity;
  }

  /* Stagger: heading first, then description */
  &.is-in-view {
    .animated-two-column-block__heading {
      opacity: 1;
      transform: translateX(0);
      transition-delay: 400ms;
    }
    .animated-two-column-block__description {
      opacity: 1;
      transform: translateX(0);
      transition-delay: 700ms;
    }
  }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .animated-two-column-block__heading,
  .animated-two-column-block__description {
    transition: none !important;
    opacity: 1 !important;
    transform: none !important;
  }
}
